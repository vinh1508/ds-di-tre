(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{30:function(e,t,n){e.exports=n(63)},55:function(e,t,n){},59:function(e,t,n){},61:function(e,t,n){},63:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(27),l=n.n(o);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var i=n(2),c=n(4),s=n(1),u=n(3),f=n(5),d=n(9),h=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(d.j,{id:"main-view",url:"/",main:!0})}},{key:"onPageBeforeIn",value:function(){}},{key:"onPageInit",value:function(){}}]),t}(r.a.Component),p=new function e(){Object(i.a)(this,e),this.F7App=null},m=n(28),v={report:"report"};Object.keys(v).map(function(e){return v[e]="http://localhost:8000/api/"+v[e]});var y=n(14),b=n.n(y),g=n(15),E=n.n(g),k=new(function(){function e(){Object(i.a)(this,e),E.a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded"}return Object(c.a)(e,[{key:"POST",value:function(e){var t=e.url,n=e.data,a=e.headers,r=void 0===a?{}:a,o={method:"POST",headers:Object(m.a)({},{"access-token":"","utc-offset":b()().utcOffset()},r),data:n,url:t};return console.log(JSON.stringify(o.headers)),E()(o)}},{key:"report",value:function(e){return this.POST({url:v.report,data:e,headers:{"Content-Type":"multipart/form-data"}})}}]),e}()),O=(n(55),[{path:"/",component:function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={fileSelected:null,jsonIput:null,enableExport:!1},n.fileSelected=null,n}return Object(f.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(d.h,{id:"Page-Home"},r.a.createElement(d.g,null,r.a.createElement(d.f,null,"Ds \u0111i tr\u1ec5")),r.a.createElement(d.b,{strong:!0},r.a.createElement("label",{id:"lblChooseFile"},"Choose a json file ...",r.a.createElement("input",{type:"file",id:"fileInput",accept:".csv",onChange:this.fileOnChange.bind(this)})),this.renderFileInfo(),this.state.jsonIput?r.a.createElement(d.c,{fill:!0,onClick:this.onCopy.bind(this)},"Download CSV"):null),r.a.createElement(d.b,{id:"items"},this.renderReportExport()))}},{key:"csvJSON",value:function(e){for(var t=e.split("\n"),n=[],a=t[0].split(","),r=1;r<t.length;r++){for(var o={},l=t[r].split(","),i=0;i<a.length;i++)o[a[i]]=l[i];n.push(o)}return JSON.stringify(n)}},{key:"fileOnChange",value:function(e){console.log("fileOnChange",e.target.files[0]);var t=e.target.files[0];this.setState({jsonIput:null,enableExport:!1}),this.fileSelected=null,t&&(this.readFileAsText(t),this.fileSelected=t,this.fileName=t.name)}},{key:"readFileAsText",value:function(e){var t=new FileReader;t.readAsText(e),t.onload=this.loadHandler.bind(this),t.onerror=this.errorHandler.bind(this)}},{key:"errorHandler",value:function(e){e.target.error&&"NotReadableError"==e.target.error.name&&console.log("Canno't read file !")}},{key:"loadHandler",value:function(e){var t=e.target,n=t.result;if(n)try{var a=this.csvJSON(n);console.log({target:t,fileSelected:this.fileSelected});var r=JSON.parse(a);this.jsonIput=r,this.enableExport=!0,console.log({jsonIput:r}),this.setState({enableExport:!0,jsonIput:r})}catch(o){console.log({error:o}),this.setState({enableExport:!1})}}},{key:"export",value:function(){}},{key:"reportOnCompleted",value:function(e){console.log("reportOnCompleted::::",e);var t=e.svg,n=new Blob([t],{type:"image/svg+xml"}),a=new FormData;a.append("svg-file",n,"fileName.svg"),a.append("description","description report"),k.report(a).then(function(e){console.log("res",e)})}},{key:"renderFileInfo",value:function(){return this.state.enableExport?r.a.createElement("div",{id:"file-info"},r.a.createElement("div",{className:"file-name"},this.fileSelected?this.fileSelected.name:"")):null}},{key:"renderThs",value:function(e,t){var n=[];return Object.keys(e).forEach(function(e,a){n.push(r.a.createElement("th",{key:"item-th-".concat(t,"-").concat(a)},e))}),n}},{key:"renderTds",value:function(e,t){var n=[];return Object.keys(e).forEach(function(a,o){n.push(r.a.createElement("td",{key:"item-td-".concat(t,"-").concat(o)},e[a]))}),n}},{key:"filterData",value:function(e){var t=b()("09:00:00","HH:mm:ss"),n={};e.forEach(function(e,t){e.Date&&(n[e.Date]||(n[e.Date]=[]),n[e.Date].push(e))});var a={};Object.keys(n).forEach(function(e,t){var r=n[e];a[e]||(a[e]={}),r.forEach(function(t){var n=t["User ID"];a[e][n]||(a[e][n]=[]),a[e][n].push(t)})});var r={};return console.log({dataByDateByUser:a}),Object.keys(a).forEach(function(e,n){var o=a[e];r[e]||(r[e]=[]),console.log({dateItems:o}),Object.keys(o).forEach(function(n,a){var l=(o[n]||[])[0];if(l){var i=l.Time,c=b()(i,"HH:mm:ss");t.diff(c)<=0&&r[e].push(l)}})}),r}},{key:"renderReportExport",value:function(){var e=this,t=[];if(!this.state.jsonIput)return null;t=this.state.jsonIput||[],t=this.filterData(t),console.log({data:t});var n=[],a=null,o=[];return Object.keys(t).forEach(function(l,i){var c=t[l];0===i&&(a=r.a.createElement("tr",{key:"item-thead-".concat(l,"-").concat(i)},e.renderThs(c[0],i))),c.forEach(function(t,a){n.push(t);var i=r.a.createElement("tr",{key:"item-".concat(l,"-").concat(a)},e.renderTds(t,a));o.push(i)})}),this.dataFiltered=n,console.log({dataFull:n}),r.a.createElement("div",{class:"data-table card"},r.a.createElement("table",null,r.a.createElement("thead",null,a),r.a.createElement("tbody",null,o)))}},{key:"convertToCSV",value:function(e){for(var t="object"!=typeof e?JSON.parse(e):e,n="",a=0;a<t.length;a++){var r="";for(var o in t[a])""!=r&&(r+=","),r+=t[a][o];n+=r+"\r\n"}return n}},{key:"exportCSVFile",value:function(e,t){var n={};Object.keys(e[0]).forEach(function(e){n[e]=e}),e.unshift(n);var a=JSON.stringify(e),r=this.convertToCSV(a),o=t+"_download.csv"||"export.csv",l=new Blob([r],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a");console.log("link.download",i.download);var c=URL.createObjectURL(l);i.className="external",i.setAttribute("href",c),i.setAttribute("download",o),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i)}},{key:"onCopy",value:function(){this.exportCSVFile(this.dataFiltered,this.fileName)}}]),t}(r.a.Component)},{path:"/not-found",component:function(){return r.a.createElement(d.h,null,r.a.createElement(d.g,{title:"My Page"}),r.a.createElement(d.d,null,r.a.createElement(d.e,{title:"Item 1"}),r.a.createElement(d.e,{title:"Item 2"})))}}]),j=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.$f7ready&&this.$f7ready(function(t){window.f7=t,t.on("routeChange",function(t,n,a){e.onRouterChange(t,n,a)}),p.F7App=t})}},{key:"onRouterChange",value:function(e,t,n){console.log(e,t,n)}},{key:"render",value:function(){var e={id:"jp.co.omron.healthcare.riskreport",name:"Risk Report",theme:"ios",routes:O};return r.a.createElement(d.a,{params:e},r.a.createElement(d.i,null),r.a.createElement(h,null))}}]),t}(r.a.Component),w=n(29);n(57),n(59),n(61);w.a.use(d.k),l.a.render(r.a.createElement(j),document.getElementById("app")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[30,2,1]]]);
//# sourceMappingURL=main.3ee5e7e3.chunk.js.map